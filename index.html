<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Moojestic</title>
    <link rel="stylesheet" href="/css/index.css">
    <!-- <link rel="stylesheet" href="http://localhost:9000/css/refresh.css"> -->
    <link rel="stylesheet" href="/css/refresh.css">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!--
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,500&display=swap" rel="stylesheet">-->
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@600&family=Lato&display=swap" rel="stylesheet">

<script type="text/javascript" src="/js/render.js"></script>
<script type="text/javascript" src="/js/loader.js"></script>

<link rel="icon" type="image/png" href="/img/cow_icon_32.png"/>
</head>
<body class="bg-dark">
     <div class="flex top-nav">
        <a id="prev-button" href="#" class="large-button">&lt;</a>
        <span>
            <p id="date" class="fs-450"></p>
            <span id="difficulty"> 
            </span>
        </span>
        <a id="next-button" href="#" class="large-button">&gt;</a>
        <a href="/info.html" class="large-button">How to Play</a>
    </div>



    <div class="container bg-dark">
        <div class="title-bar flex"><img src="/img/cow_icon.png"/>
            <div class="flow" >
                <h1>Moojestic </h1>
                <p id="error"></p>
            </div>
        </div>
        <div class="margin-in">
            <div id="puzzle" class="grid"></div>
        </div>

        <div id="answer-area" class="hidden">
            <div class="flex margin-top">
                <input type="text" autocomplete="off" placeholder="Answer" id="answer-input" oninput="onAnswerTextChanged(this);"/>
                <button id="clear-button" class="large-button text-light bg-dark-button" onclick="clearAnswer();"> Clear </button>
            </div>
            <div>
                <p id="feedback"></p>
            </div>
        </div>
    <div>


    <div id="available-area" class="available-area-off">
        <div class="word flex">
            <span id="av-a"> a </span>
            <span id="av-b"> b </span>
            <span id="av-c"> c </span>
            <span id="av-d"> d </span>
            <span id="av-e"> e </span>
            <span id="av-f"> f </span>
            <span id="av-g"> g </span>
            <span id="av-h"> h </span>
            <span id="av-i"> i </span>
            <span id="av-j"> j </span>
            <span id="av-k"> k </span>
            <span id="av-l"> l </span>
            <span id="av-m"> m </span>
        </div>
        <div  class="word flex">
            <span id="av-n"> n </span>
            <span id="av-o"> o </span>
            <span id="av-p"> p </span>
            <span id="av-q"> q </span>
            <span id="av-r"> r </span>
            <span id="av-s"> s </span>
            <span id="av-t"> t </span>
            <span id="av-u"> u </span>
            <span id="av-v"> v </span>
            <span id="av-w"> w </span>
            <span id="av-x"> x </span>
            <span id="av-y"> y </span>
            <span id="av-z"> z </span>
        </div>
    </div>



<script type="text/javascript">
var loadedPuzzle = {};    
var correctAnswer = "";    
var todaysPuzzle = todaysPuzzleIndex();
var displayPuzzle = todaysPuzzle;
var answerField = document.getElementById("answer-input");
var clearButton = document.getElementById("clear-button");
var feedbackTag = document.getElementById("feedback");
var prevButton = document.getElementById("prev-button");
var nextButton = document.getElementById("next-button");

function onAnswerTextChanged(field) {
    if (field.value.length > correctAnswer.length) {
        field.value = field.value.substring(0, correctAnswer.length);
    }
    if (field.value.length == correctAnswer.length) {
        if (field.value.toLowerCase() == correctAnswer) {
            field.className = "solved";
            field.setAttribute("disabled", "disabled");
            clearButton.className = "hidden";
            feedbackTag.innerText = "You got it!";
        } 
        else {
            showErrorFeedback(field.value.toLowerCase(), loadedPuzzle);
        }
    }
    else {
        clearErrorFeedback();
    }
}

function clearAnswer() {
    answerField.value = "";
    feedbackTag.innerText = "";
    clearErrorFeedback();
}

function setErrorMsg(msg) {
    document.getElementById("error").innerText = msg;
}

function onLoadFail(n) {
  setErrorMsg("Failed to load Puzzle #" + n); 
}    

if (window.location.search.startsWith("?puzzle=")) {
    displayPuzzle = parseInt(window.location.search.substring(8));
    if (displayPuzzle <= todaysPuzzle) {
        loadPuzzleNumber(displayPuzzle, onLoadFail);
    }
    else {
        setErrorMsg("Puzzle #" + displayPuzzle + " is not ready yet. Come back later!");
    }
}
else {
    loadPuzzleNumber(todaysPuzzle, onLoadFail);
}

if (displayPuzzle < todaysPuzzle) {
    nextButton.setAttribute("href", "/index.html?puzzle=" + (displayPuzzle+1));
}
else {
    nextButton.className += " hidden";
}

if (displayPuzzle > 1) {
    prevButton.setAttribute("href", "/index.html?puzzle=" + (displayPuzzle-1));
}
else {
    prevButton.className += " hidden";
}

</script>

<!--------- Dev Refresh Script  ------------->
<p id="refresh" class="hidden"/>
<script type="text/javascript" src="/js/dev_refresh.js"></script>
</body>

</htmnl> 